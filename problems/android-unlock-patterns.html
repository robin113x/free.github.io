<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <meta name="description" content="Given an Android 3x3 key lock screen and two integers m and n, where  1 ≤ m ≤ n ≤ 9, count the total number of unlock patterns of the Android lock screen, which consist of minimum of m keys and maximum n keys.
Rules for a valid pattern:

Each pattern must connect at least m keys and at most n keys.
All the keys must be distinct.
If the line connecting two consecutive keys in the pattern passes through any other keys, the other keys must have previously selected in the pattern. No jumps through non selected key is allowed.
The order of keys used matters.



Explanation:
| 1 | 2 | 3 |
| 4 | 5 | 6 |
| 7 | 8 | 9 |


Invalid move: 4 - 1 - 3 - 6 

Line  1 - 3 passes through key 2 which had not been selected in the pattern.
Invalid move: 4 - 1 - 9 - 2

Line  1 - 9 passes through key 5 which had not been selected in the pattern.
Valid move: 2 - 4 - 1 - 3 - 6

Line 1 - 3 is valid because it passes through key 2, which had been selected in the pattern
Valid move: 6 - 5 - 4 - 1 - 9 - 2

Line 1 - 9 is valid because it passes through key 5, which had been selected in the pattern.
Example:
Given m = 1, n = 1, return 9.

Credits:Special thanks to @elmirap for adding this problem and creating all test cases.">
  <meta name="keywords"
        content="Android Unlock Patterns, LC 351, leetcode 351, leaked interview questions, hackerank free, bittiger free"/>



  <meta name="author" content="">
  <link rel="icon" href="../favicon.ico">

  <title>LeetFree - Leaked Interview questions from Google Facebook Amazon Microsoft LinkedIn</title>

  <!-- Bootstrap core CSS -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">

  <link href="https://use.fontawesome.com/releases/v5.0.1/css/all.css" rel="stylesheet">

  <!-- <link href="/css/fontawesome-all.min.css" rel="stylesheet"> -->
  <!-- <link href="/css/open-iconic-bootstrap.min.css" rel="stylesheet"> -->

  <!-- DataTable -->
  <!-- <link href="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0-beta/css/bootstrap.css" rel="stylesheet">
  <link href="https://cdn.datatables.net/1.10.16/css/dataTables.bootstrap4.min.css" rel="stylesheet"> -->

  
  <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/css/select2.min.css" rel="stylesheet"/>
  <!--<link href="/css/codemirror.css" rel="stylesheet">-->

  <style type="text/css">.CodeMirror {
      border: 1px solid gray;
      height: 100%;
    }
  </style>



  <!-- Custom styles for this template -->
  <link href="../maincss.css" rel="stylesheet">


  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-111377072-1"></script>
  <script>
      window.dataLayer = window.dataLayer || [];

      function gtag() {
          dataLayer.push(arguments);
      }

      gtag('js', new Date());

      gtag('config', 'UA-111377072-1');
  </script>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({
      google_ad_client: "ca-pub-8728288618103299",
      enable_page_level_ads: true
    });
  </script>

  <!-- Baidu Analytics -->









</head>

<body>

<div class="blog-masthead">
  <div class="container">
    <nav class="blog-nav">
      <a class="blog-nav-item" href="../index.html">All Questions</a>
      <a class="blog-nav-item" href="../company/google.html">Google</a>
      <a class="blog-nav-item" href="../company/facebook.html">Facebook</a>
      <a class="blog-nav-item" href="../company/microsoft.html">Microsoft</a>
      <a class="blog-nav-item" href="../company/amazon.html">Amazon</a>
      <a class="blog-nav-item" href="../company/uber.html">Uber</a>
      <a class="blog-nav-item" href="../company/linkedin.html">LinkedIn</a>
      <a class="blog-nav-item" href="../company/twitter.html">Twitter</a>
      <a class="blog-nav-item" href="../company/airbnb.html">Airbnb</a>
      <a class="blog-nav-item" href="../company/snapchat.html">Snapchat</a>
    </nav>
  </div>
</div>

<div class="container">
  

  <div class="blog-header">
    <div class="alert alert-info" role="alert">This website contains ALL LeetCode <b>Premium</b> <i
            class="fas fa-unlock-alt"></i> problems for
      <b>FREE!!</b>.<br/>
      All leaked interview problems are collected from Internet.
    </div>

    <h2>351. Android Unlock Patterns</h2>
  </div>

  <div class="row">
    <div class="col-md-9 blog-main">
      <div>
        <!-- Nav tabs -->
        <ul class="nav nav-tabs" role="tablist" id="myTabs">
          <li role="presentation" class="active" id="question-li"><a href="#question" aria-controls="question"
                                                                     role="tab"
                                                                     data-toggle="tab">Question</a>
          </li>
          <li role="presentation" id="solution-li"><a href="#solution" aria-controls="solution" role="tab"
                                                      data-toggle="tab"><i class="fas fa-unlock-alt"></i> Solution</a>
          </li>
        </ul>

        <!-- Tab panes -->
        <div class="tab-content">

          <div role="tabpanel" class="tab-pane active" id="question">
            <br/>
            <p>
Given an Android <b>3x3</b> key lock screen and two integers <b>m</b> and <b>n</b>, where  1 &le; m &le; n &le; 9, count the total number of unlock patterns of the Android lock screen, which consist of minimum of <b>m</b> keys and maximum <b>n</b> keys.</p>

<p><b>Rules for a valid pattern:</b><br />
<ol>
<li>Each pattern must connect at least <b>m</b> keys and at most <b>n</b> keys.</li>
<li>All the keys must be distinct.</li>
<li>If the line connecting two consecutive keys in the pattern passes through any other keys, the other keys must have previously selected in the pattern. No jumps through non selected key is allowed.</li>
<li>The order of keys used matters.</li>
</ol>
</p>

<img src="https://leetcode.com/static/images/problemset/android-unlock.png" />

<p><b>Explanation:</b><br />

<pre>| 1 | 2 | 3 |
| 4 | 5 | 6 |
| 7 | 8 | 9 |</pre>
</p>

<p>
<b>Invalid move:</b> <code>4 - 1 - 3 - 6 </code><br />

Line  1 - 3 passes through key 2 which had not been selected in the pattern.</p>

<p><b>Invalid move:</b> <code>4 - 1 - 9 - 2</code><br />

Line  1 - 9 passes through key 5 which had not been selected in the pattern.</p>

<p><b>Valid move:</b> <code>2 - 4 - 1 - 3 - 6</code><br />

Line 1 - 3 is valid because it passes through key 2, which had been selected in the pattern</p>

<p><b>Valid move:</b> <code>6 - 5 - 4 - 1 - 9 - 2</code><br />

Line 1 - 9 is valid because it passes through key 5, which had been selected in the pattern.</p>

<p><b>Example:</b><br />
Given <b>m</b> = 1, <b>n</b> = 1, return 9.
</p>

<p><b>Credits:</b><br />Special thanks to <a href="https://discuss.leetcode.com/user/elmirap">@elmirap</a> for adding this problem and creating all test cases.</p>
          </div>
          <div role="tabpanel" class="tab-pane" id="solution">
            <br/>
            <div class="block-markdown">
<div class="toc">
<ul>
<li><a href="#summary">Summary</a></li>
<li><a href="#solution">Solution</a><ul>
<li><a href="#approach-1-backtracking-accepted">Approach #1: (Backtracking) [Accepted]</a></li>
</ul>
</li>
<li><a href="#further-thoughts">Further Thoughts</a></li>
</ul>
</div>
<h2 id="summary">Summary</h2>
<p>After Android launched its "unlock pattern" system to protect our smart phones from unauthorized access, the most common question that comes to one's mind is: How secure exactly are these patterns? The current article gives an answer to this question, as presenting an algorithm, which computes the number of all valid pattern combinations. It is intended for intermediate users and introduces the following ideas:
Backtracking, Arrays.</p>
<h2 id="solution">Solution</h2>
<hr/>
<h4 id="approach-1-backtracking-accepted">Approach #1: (Backtracking) [Accepted]</h4>
<p><strong>Algorithm</strong></p>
<p>The algorithm uses backtracking technique to enumerate all possible <script type="math/tex; mode=display">k</script> combinations of numbers <script type="math/tex; mode=display">[1\dots\ 9]</script> where <script type="math/tex; mode=display">m \leq k \leq n</script>. During the generation of the recursive solution tree, the algorithm cuts all the branches  which lead to patterns which doesn't satisfy the rules and counts only the valid patterns.
In order to compute a valid pattern, the algorithm performs the following steps:</p>
<ul>
<li>
<p>Select a digit <script type="math/tex; mode=display">i</script> which is not used in the pattern till this moment. This is done with the help of a <script type="math/tex; mode=display">used</script> array which stores all available digits.</p>
</li>
<li>
<p>We need to keep last inserted digit <script type="math/tex; mode=display">last</script>. The algorithm makes a check whether one of the following conditions is valid.</p>
<ul>
<li>
<p>There is a knight move (as in chess)  from <script type="math/tex; mode=display">last</script> towards <script type="math/tex; mode=display">i</script> or <script type="math/tex; mode=display">last</script> and <script type="math/tex; mode=display">i</script> are adjacent digits in a row, in a column. In this case the sum of both digits should be an odd number.</p>
</li>
<li>
<p>The middle element <script type="math/tex; mode=display">mid</script> in the line which connects <script type="math/tex; mode=display">i</script> and <script type="math/tex; mode=display">last</script> was previously selected. In case <script type="math/tex; mode=display">i</script> and <script type="math/tex; mode=display">last</script> are positioned at both ends of the diagonal, digit <script type="math/tex; mode=display">mid</script> = 5 should be previously selected.</p>
</li>
<li>
<p>
<script type="math/tex; mode=display">last</script> and <script type="math/tex; mode=display">i</script> are adjacent digits in a diagonal</p>
</li>
</ul>
</li>
</ul>
<p>In case one of the conditions above is satisfied, digit <script type="math/tex; mode=display">i</script> becomes part of partially generated valid pattern and the algorithm continues with the next candidate digit till the pattern is fully generated. Then it counts it.
In case none of the conditions are satisfied, the algorithm rejects the current digit <script type="math/tex; mode=display">i</script>, backtracks and continues to search for other valid digits among the unused ones.</p>
<p align="center"><img alt="Android unlock pattern recursive solution tree" src="https://leetcode.com/media/original_images/351_Android.png" width="80%"/></p>
<p><strong>Java</strong></p>
<div class="codehilite"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Solution</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kt">boolean</span> <span class="n">used</span><span class="o">[]</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">boolean</span><span class="o">[</span><span class="mi">9</span><span class="o">];</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">numberOfPatterns</span><span class="o">(</span><span class="kt">int</span> <span class="n">m</span><span class="o">,</span> <span class="kt">int</span> <span class="n">n</span><span class="o">)</span> <span class="o">{</span>         
        <span class="kt">int</span> <span class="n">res</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">len</span> <span class="o">=</span> <span class="n">m</span><span class="o">;</span> <span class="n">len</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="o">;</span> <span class="n">len</span><span class="o">++)</span> <span class="o">{</span>                
            <span class="n">res</span> <span class="o">+=</span> <span class="n">calcPatterns</span><span class="o">(-</span><span class="mi">1</span><span class="o">,</span> <span class="n">len</span><span class="o">);</span>
            <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">9</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>                   
                <span class="n">used</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
            <span class="o">}</span>            
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">res</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">boolean</span> <span class="nf">isValid</span><span class="o">(</span><span class="kt">int</span> <span class="n">index</span><span class="o">,</span> <span class="kt">int</span> <span class="n">last</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">used</span><span class="o">[</span><span class="n">index</span><span class="o">])</span>
            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
        <span class="c1">// first digit of the pattern    </span>
        <span class="k">if</span> <span class="o">(</span><span class="n">last</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="o">)</span>
            <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
        <span class="c1">// knight moves or adjacent cells (in a row or in a column)        </span>
        <span class="k">if</span> <span class="o">((</span><span class="n">index</span> <span class="o">+</span> <span class="n">last</span><span class="o">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="o">)</span>
            <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
        <span class="c1">// indexes are at both end of the diagonals for example 0,0, and 8,8          </span>
        <span class="kt">int</span> <span class="n">mid</span> <span class="o">=</span> <span class="o">(</span><span class="n">index</span> <span class="o">+</span> <span class="n">last</span><span class="o">)/</span><span class="mi">2</span><span class="o">;</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">mid</span> <span class="o">==</span> <span class="mi">4</span><span class="o">)</span>
            <span class="k">return</span> <span class="n">used</span><span class="o">[</span><span class="n">mid</span><span class="o">];</span>
        <span class="c1">// adjacent cells on diagonal  - for example 0,0 and 1,0 or 2,0 and //1,1</span>
        <span class="k">if</span> <span class="o">((</span><span class="n">index</span><span class="o">%</span><span class="mi">3</span> <span class="o">!=</span> <span class="n">last</span><span class="o">%</span><span class="mi">3</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="o">(</span><span class="n">index</span><span class="o">/</span><span class="mi">3</span> <span class="o">!=</span> <span class="n">last</span><span class="o">/</span><span class="mi">3</span><span class="o">))</span> <span class="o">{</span>
            <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="c1">// all other cells which are not adjacent</span>
        <span class="k">return</span> <span class="n">used</span><span class="o">[</span><span class="n">mid</span><span class="o">];</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">int</span> <span class="nf">calcPatterns</span><span class="o">(</span><span class="kt">int</span> <span class="n">last</span><span class="o">,</span> <span class="kt">int</span> <span class="n">len</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">len</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span>
            <span class="k">return</span> <span class="mi">1</span><span class="o">;</span>    
        <span class="kt">int</span> <span class="n">sum</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">9</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">isValid</span><span class="o">(</span><span class="n">i</span><span class="o">,</span> <span class="n">last</span><span class="o">))</span> <span class="o">{</span>
                <span class="n">used</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
                <span class="n">sum</span> <span class="o">+=</span> <span class="n">calcPatterns</span><span class="o">(</span><span class="n">i</span><span class="o">,</span> <span class="n">len</span> <span class="o">-</span> <span class="mi">1</span><span class="o">);</span>
                <span class="n">used</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>                    
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">sum</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
<p><strong>Complexity Analysis</strong></p>
<ul>
<li>
<p>Time complexity : <script type="math/tex; mode=display">O( n!)</script>, where <script type="math/tex; mode=display">n</script> is maximum pattern length</p>
<p>The algorithm computes each pattern once and no element can appear in the pattern twice. The time complexity is proportional to the number of the computed patterns. One upper bound of the number of all possible combinations is :</p>
</li>
</ul>
<p>
<script type="math/tex; mode=display">
\ \sum_{i=m}^{n} {_9}P_i = \ \sum_{i=m}^{n} \frac{9!}{(9 - i)!}
</script>
</p>
<ul>
<li>Space complexity : <script type="math/tex; mode=display">O(n)</script>, where <script type="math/tex; mode=display">n</script> is maximum pattern length
In the worst case the maximum depth of recursion is <script type="math/tex; mode=display">n</script>. Therefore we need <script type="math/tex; mode=display">O( n)</script> space used by the system recursive stack</li>
</ul>
<h2 id="further-thoughts">Further Thoughts</h2>
<p>The algorithm above could be optimized if we consider the symmetry property of the problem. We notice that the number of valid patterns with first digit 1, 3, 7, 9 are the same. A similar observation is true for patterns which starts with digit 2, 4, 6, 8.  Hence we only  need to calculate one among each group and multiply by 4.</p>
<p>You can find the optimized solution <a href="https://leetcode.com/discuss/104500/java-solution-with-clear-explanations-and-optimization-81ms">here</a>.</p>
<p>Analysis written by: @elmirap.</p>
</div>
          </div>
        </div>
      </div>

    </div>

    <aside class="col-md-3  blog-sidebar">
      <div class="row sidebar-module">
        <ul class="list-group">
          <li class="list-group-item"><span>Difficulty:</span><span class="pull-right">
                              
                                <button class="btn btn-xs btn-warning disabled">Medium</button>
                              
          </span></li>
          <li class="list-group-item"><span>Total Accepted:</span><span class="pull-right">17462</span>
          </li>
          <li class="list-group-item"><span>Total Submissions:</span><span
                  class="pull-right">39288</span></li>

          <li class="list-group-item" style="background: #eee;"><span><i
                  class="fas fa-unlock-alt"></i> Frequency:</span>
            <span class="pull-right">
              29%
            </span>
          </li>
        </ul>
        <ul class="list-group">

          <li class="list-group-item">
            <h4><i class="fas fa-unlock-alt"></i> Companies (leaked): </h4>
            
              <a style="margin:2px" class="btn btn-sm btn-success" href="../company/google.html">Google</a>
            
          </li>

        </ul>
      </div>
    </aside>

  </div>

  <div class="row" >
    <div class="col-md-2">
      <select class="js-example-basic-single" name="state" style="width: 100%;" id="language">
        <option value="cpp">C++</option>
        <option value="py2">Python 2</option>
        <option value="py3">Python 3</option>
      </select>
    </div>
    <div class="col-md-2">

    </div>
  </div>

  <div class="row" >
    <div class="col-md-12 blog-main">
      <div>
        
        <textarea id="code_cpp" name="code_cpp">
          
            
        </textarea>
        
        <textarea id="code_py2" name="code_py2">
          
            
        </textarea>
        
        <textarea id="code_py3" name="code_py3">
          
            
        </textarea>
        
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-md-12 blog-main">
      <a href="#" class="btn btn-primary" id="submit">Submit Solution</a>
    </div>
  </div>



</div>
<!-- /.container -->

<footer class="blog-footer">
  <a href="mailto:leetfree@gmail.com">Email: leetfree@gmail.com</a>
  <p class="pull-right"><a href="#">Back to top</a></p>
</footer>

<!-- Bootstrap core JavaScript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script>
    window.jQuery || document.write('<script src="/assets/js/vendor/jquery.min.js"><\/script>')
</script>
<script src="../js/bootstrap.min.js"></script>
<!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
<script src="../assets/js/ie10-viewport-bug-workaround.js"></script>


<!-- DataTable -->
<!-- <script src="https://cdn.datatables.net/1.10.16/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.10.16/js/dataTables.bootstrap4.min.js"></script> -->

<script src="../main.js"></script>





</body>

</html>
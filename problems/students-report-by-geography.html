<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <meta name="description" content="A U.S graduate school has students from Asia, Europe and America. The students&#39; location information are stored in table student as below.">
  <meta name="keywords"
        content="Students Report By Geography, LC 618, leetcode 618, leaked interview questions, hackerank free, bittiger free"/>



  <meta name="author" content="">
  <link rel="icon" href="../favicon.ico">

  <title>LeetFree - Leaked Interview questions from Google Facebook Amazon Microsoft LinkedIn</title>

  <!-- Bootstrap core CSS -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">

  <link href="https://use.fontawesome.com/releases/v5.0.1/css/all.css" rel="stylesheet">

  <!-- <link href="/css/fontawesome-all.min.css" rel="stylesheet"> -->
  <!-- <link href="/css/open-iconic-bootstrap.min.css" rel="stylesheet"> -->

  <!-- DataTable -->
  <!-- <link href="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0-beta/css/bootstrap.css" rel="stylesheet">
  <link href="https://cdn.datatables.net/1.10.16/css/dataTables.bootstrap4.min.css" rel="stylesheet"> -->

  
  <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/css/select2.min.css" rel="stylesheet"/>
  <!--<link href="/css/codemirror.css" rel="stylesheet">-->

  <style type="text/css">.CodeMirror {
      border: 1px solid gray;
      height: 100%;
    }
  </style>



  <!-- Custom styles for this template -->
  <link href="../maincss.css" rel="stylesheet">


  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-111377072-1"></script>
  <script>
      window.dataLayer = window.dataLayer || [];

      function gtag() {
          dataLayer.push(arguments);
      }

      gtag('js', new Date());

      gtag('config', 'UA-111377072-1');
  </script>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({
      google_ad_client: "ca-pub-8728288618103299",
      enable_page_level_ads: true
    });
  </script>

  <!-- Baidu Analytics -->









</head>

<body>

<div class="blog-masthead">
  <div class="container">
    <nav class="blog-nav">
      <a class="blog-nav-item" href="../index.html">All Questions</a>
      <a class="blog-nav-item" href="../company/google.html">Google</a>
      <a class="blog-nav-item" href="../company/facebook.html">Facebook</a>
      <a class="blog-nav-item" href="../company/microsoft.html">Microsoft</a>
      <a class="blog-nav-item" href="../company/amazon.html">Amazon</a>
      <a class="blog-nav-item" href="../company/uber.html">Uber</a>
      <a class="blog-nav-item" href="../company/linkedin.html">LinkedIn</a>
      <a class="blog-nav-item" href="../company/twitter.html">Twitter</a>
      <a class="blog-nav-item" href="../company/airbnb.html">Airbnb</a>
      <a class="blog-nav-item" href="../company/snapchat.html">Snapchat</a>
    </nav>
  </div>
</div>

<div class="container">
  

  <div class="blog-header">
    <div class="alert alert-info" role="alert">This website contains ALL LeetCode <b>Premium</b> <i
            class="fas fa-unlock-alt"></i> problems for
      <b>FREE!!</b>.<br/>
      All leaked interview problems are collected from Internet.
    </div>

    <h2>618. Students Report By Geography</h2>
  </div>

  <div class="row">
    <div class="col-md-9 blog-main">
      <div>
        <!-- Nav tabs -->
        <ul class="nav nav-tabs" role="tablist" id="myTabs">
          <li role="presentation" class="active" id="question-li"><a href="#question" aria-controls="question"
                                                                     role="tab"
                                                                     data-toggle="tab">Question</a>
          </li>
          <li role="presentation" id="solution-li"><a href="#solution" aria-controls="solution" role="tab"
                                                      data-toggle="tab"><i class="fas fa-unlock-alt"></i> Solution</a>
          </li>
        </ul>

        <!-- Tab panes -->
        <div class="tab-content">

          <div role="tabpanel" class="tab-pane active" id="question">
            <br/>
            A U.S graduate school has students from Asia, Europe and America. The students' location information are stored in table <code>student</code> as below.</p>
 
<pre>
| name   | continent |
|--------|-----------|
| Jack   | America   |
| Pascal | Europe    |
| Xi     | Asia      |
| Jane   | America   |
</pre></p>
 
<a href="https://en.wikipedia.org/wiki/Pivot_table"> Pivot</a> the continent column in this table so that each name is sorted alphabetically and displayed underneath its corresponding continent. The output headers should be America, Asia and Europe respectively. It is guaranteed that the student number from America is no less than either Asia or Europe.</p>
 
For the sample input, the output is:</p>
<pre>
| America | Asia | Europe |
|---------|------|--------|
| Jack    | Xi   | Pascal |
| Jane    |      |        |
</pre></p>
 
<b>Follow-up:</b> If it is unknown which continent has the most students, can you write a query to generate the student report?</p>
          </div>
          <div role="tabpanel" class="tab-pane" id="solution">
            <br/>
            <div class="block-markdown">
<div class="toc">
<ul>
<li><a href="#solution">Solution</a><ul>
<li><a href="#approach-using-session-variables-and-join-accepted">Approach: Using "session variables" and join [Accepted]</a></li>
</ul>
</li>
</ul>
</div>
<h2 id="solution">Solution</h2>
<hr/>
<h4 id="approach-using-session-variables-and-join-accepted">Approach: Using "session variables" and <code>join</code> [Accepted]</h4>
<p><strong>Intuition</strong></p>
<p>Assign a separate auto increment row id to each of the continent, and then join them together.</p>
<p><strong>Algorithm</strong></p>
<p>To set the row id for each continent, we need to use session variables.
For example, we can use the following statement to assign a auto increment row number for students in America.</p>
<div class="codehilite"><pre><span></span><span class="k">SELECT</span> 
    <span class="n">row_id</span><span class="p">,</span> <span class="n">America</span>
<span class="k">FROM</span>
    <span class="p">(</span><span class="k">SELECT</span> <span class="o">@</span><span class="n">am</span><span class="p">:</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="n">t</span><span class="p">,</span>
    <span class="p">(</span><span class="k">SELECT</span> 
        <span class="o">@</span><span class="n">am</span><span class="p">:</span><span class="o">=@</span><span class="n">am</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">AS</span> <span class="n">row_id</span><span class="p">,</span> <span class="n">name</span> <span class="k">AS</span> <span class="n">America</span>
    <span class="k">FROM</span>
        <span class="n">student</span>
    <span class="k">WHERE</span>
        <span class="n">continent</span> <span class="o">=</span> <span class="s1">'America'</span>
    <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">America</span><span class="p">)</span> <span class="k">AS</span> <span class="n">t2</span>
<span class="p">;</span>
</pre></div>
<div class="codehilite"><pre><span></span>| row_id | America |
|--------|---------|
| 1      | Jack    |
| 2      | Jane    |
</pre></div>
<p>Similarly, we can assign other dedicated row id for other continents as the following result.</p>
<div class="codehilite"><pre><span></span>| row_id | Asia |
|--------|------|
| 1      | Xi   |

| row_id | Europe |
|--------|--------|
| 1      | Jesper |
</pre></div>
<p>Then if we join these 3 temp tables together and using the same row_id as the condition, we can have the following table.</p>
<div class="codehilite"><pre><span></span>| row_id | America | Asia | Europe |
|--------|---------|------|--------|
| 1      | Jack    | Xi   | Pascal |
| 2      | Jane    |      |        |
</pre></div>
<p>One issue you may encounter is the student list for America is not complete if you use regular inner join since there are more records in this list comparing with the other two. So you may have a solution to use the <code>outer join</code>. Correct! But how to arrange the 3 tables? The trick is to put the America list in the middle so that we can use <code>right (outer) join</code> and <code>right (outer) join</code> to connect with other two tables.</p>
<p><strong>MySQL</strong></p>
<div class="codehilite"><pre><span></span><span class="k">SELECT</span> 
    <span class="n">America</span><span class="p">,</span> <span class="n">Asia</span><span class="p">,</span> <span class="n">Europe</span>
<span class="k">FROM</span>
    <span class="p">(</span><span class="k">SELECT</span> <span class="o">@</span><span class="k">as</span><span class="p">:</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">@</span><span class="n">am</span><span class="p">:</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">@</span><span class="n">eu</span><span class="p">:</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="n">t</span><span class="p">,</span>
    <span class="p">(</span><span class="k">SELECT</span> 
        <span class="o">@</span><span class="k">as</span><span class="p">:</span><span class="o">=@</span><span class="k">as</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">AS</span> <span class="n">asid</span><span class="p">,</span> <span class="n">name</span> <span class="k">AS</span> <span class="n">Asia</span>
    <span class="k">FROM</span>
        <span class="n">student</span>
    <span class="k">WHERE</span>
        <span class="n">continent</span> <span class="o">=</span> <span class="s1">'Asia'</span>
    <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">Asia</span><span class="p">)</span> <span class="k">AS</span> <span class="n">t1</span>
        <span class="k">RIGHT</span> <span class="k">JOIN</span>
    <span class="p">(</span><span class="k">SELECT</span> 
        <span class="o">@</span><span class="n">am</span><span class="p">:</span><span class="o">=@</span><span class="n">am</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">AS</span> <span class="n">amid</span><span class="p">,</span> <span class="n">name</span> <span class="k">AS</span> <span class="n">America</span>
    <span class="k">FROM</span>
        <span class="n">student</span>
    <span class="k">WHERE</span>
        <span class="n">continent</span> <span class="o">=</span> <span class="s1">'America'</span>
    <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">America</span><span class="p">)</span> <span class="k">AS</span> <span class="n">t2</span> <span class="k">ON</span> <span class="n">asid</span> <span class="o">=</span> <span class="n">amid</span>
        <span class="k">LEFT</span> <span class="k">JOIN</span>
    <span class="p">(</span><span class="k">SELECT</span> 
        <span class="o">@</span><span class="n">eu</span><span class="p">:</span><span class="o">=@</span><span class="n">eu</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">AS</span> <span class="n">euid</span><span class="p">,</span> <span class="n">name</span> <span class="k">AS</span> <span class="n">Europe</span>
    <span class="k">FROM</span>
        <span class="n">student</span>
    <span class="k">WHERE</span>
        <span class="n">continent</span> <span class="o">=</span> <span class="s1">'Europe'</span>
    <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">Europe</span><span class="p">)</span> <span class="k">AS</span> <span class="n">t3</span> <span class="k">ON</span> <span class="n">amid</span> <span class="o">=</span> <span class="n">euid</span>
<span class="p">;</span>
</pre></div>
</div>
          </div>
        </div>
      </div>

    </div>

    <aside class="col-md-3  blog-sidebar">
      <div class="row sidebar-module">
        <ul class="list-group">
          <li class="list-group-item"><span>Difficulty:</span><span class="pull-right">
                              
                                <button class="btn btn-xs btn-danger disabled">Hard</button>
                              
          </span></li>
          <li class="list-group-item"><span>Total Accepted:</span><span class="pull-right">542</span>
          </li>
          <li class="list-group-item"><span>Total Submissions:</span><span
                  class="pull-right">1255</span></li>

          <li class="list-group-item" style="background: #eee;"><span><i
                  class="fas fa-unlock-alt"></i> Frequency:</span>
            <span class="pull-right">
              6%
            </span>
          </li>
        </ul>
        <ul class="list-group">

          <li class="list-group-item">
            <h4><i class="fas fa-unlock-alt"></i> Companies (leaked): </h4>
            
          </li>

        </ul>
      </div>
    </aside>

  </div>

  <div class="row" >
    <div class="col-md-2">
      <select class="js-example-basic-single" name="state" style="width: 100%;" id="language">
        <option value="cpp">C++</option>
        <option value="py2">Python 2</option>
        <option value="py3">Python 3</option>
      </select>
    </div>
    <div class="col-md-2">

    </div>
  </div>

  <div class="row" >
    <div class="col-md-12 blog-main">
      <div>
        
        <textarea id="code_cpp" name="code_cpp">
          
            
        </textarea>
        
        <textarea id="code_py2" name="code_py2">
          
            
        </textarea>
        
        <textarea id="code_py3" name="code_py3">
          
            
        </textarea>
        
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-md-12 blog-main">
      <a href="#" class="btn btn-primary" id="submit">Submit Solution</a>
    </div>
  </div>



</div>
<!-- /.container -->

<footer class="blog-footer">
  <a href="mailto:leetfree@gmail.com">Email: leetfree@gmail.com</a>
  <p class="pull-right"><a href="#">Back to top</a></p>
</footer>

<!-- Bootstrap core JavaScript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script>
    window.jQuery || document.write('<script src="/assets/js/vendor/jquery.min.js"><\/script>')
</script>
<script src="../js/bootstrap.min.js"></script>
<!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
<script src="../assets/js/ie10-viewport-bug-workaround.js"></script>


<!-- DataTable -->
<!-- <script src="https://cdn.datatables.net/1.10.16/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.10.16/js/dataTables.bootstrap4.min.js"></script> -->

<script src="../main.js"></script>





</body>

</html>
<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <meta name="description" content="Given a table tree, id is identifier of the tree node and p_id is its parent node&#39;s id.


+----+------+
| id | p_id |
+----+------+
| 1  | null |
| 2  | 1    |
| 3  | 1    |
| 4  | 2    |
| 5  | 2    |
+----+------+

 
Each node in the tree can be one of three types:">
  <meta name="keywords"
        content="Tree Node, LC 608, leetcode 608, leaked interview questions, hackerank free, bittiger free"/>



  <meta name="author" content="">
  <link rel="icon" href="../favicon.ico">

  <title>LeetFree - Leaked Interview questions from Google Facebook Amazon Microsoft LinkedIn</title>

  <!-- Bootstrap core CSS -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">

  <link href="https://use.fontawesome.com/releases/v5.0.1/css/all.css" rel="stylesheet">

  <!-- <link href="/css/fontawesome-all.min.css" rel="stylesheet"> -->
  <!-- <link href="/css/open-iconic-bootstrap.min.css" rel="stylesheet"> -->

  <!-- DataTable -->
  <!-- <link href="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0-beta/css/bootstrap.css" rel="stylesheet">
  <link href="https://cdn.datatables.net/1.10.16/css/dataTables.bootstrap4.min.css" rel="stylesheet"> -->

  
  <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/css/select2.min.css" rel="stylesheet"/>
  <!--<link href="/css/codemirror.css" rel="stylesheet">-->

  <style type="text/css">.CodeMirror {
      border: 1px solid gray;
      height: 100%;
    }
  </style>



  <!-- Custom styles for this template -->
  <link href="../maincss.css" rel="stylesheet">


  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-111377072-1"></script>
  <script>
      window.dataLayer = window.dataLayer || [];

      function gtag() {
          dataLayer.push(arguments);
      }

      gtag('js', new Date());

      gtag('config', 'UA-111377072-1');
  </script>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({
      google_ad_client: "ca-pub-8728288618103299",
      enable_page_level_ads: true
    });
  </script>

  <!-- Baidu Analytics -->









</head>

<body>

<div class="blog-masthead">
  <div class="container">
    <nav class="blog-nav">
      <a class="blog-nav-item" href="../index.html">All Questions</a>
      <a class="blog-nav-item" href="../company/google.html">Google</a>
      <a class="blog-nav-item" href="../company/facebook.html">Facebook</a>
      <a class="blog-nav-item" href="../company/microsoft.html">Microsoft</a>
      <a class="blog-nav-item" href="../company/amazon.html">Amazon</a>
      <a class="blog-nav-item" href="../company/uber.html">Uber</a>
      <a class="blog-nav-item" href="../company/linkedin.html">LinkedIn</a>
      <a class="blog-nav-item" href="../company/twitter.html">Twitter</a>
      <a class="blog-nav-item" href="../company/airbnb.html">Airbnb</a>
      <a class="blog-nav-item" href="../company/snapchat.html">Snapchat</a>
    </nav>
  </div>
</div>

<div class="container">
  

  <div class="blog-header">
    <div class="alert alert-info" role="alert">This website contains ALL LeetCode <b>Premium</b> <i
            class="fas fa-unlock-alt"></i> problems for
      <b>FREE!!</b>.<br/>
      All leaked interview problems are collected from Internet.
    </div>

    <h2>608. Tree Node</h2>
  </div>

  <div class="row">
    <div class="col-md-9 blog-main">
      <div>
        <!-- Nav tabs -->
        <ul class="nav nav-tabs" role="tablist" id="myTabs">
          <li role="presentation" class="active" id="question-li"><a href="#question" aria-controls="question"
                                                                     role="tab"
                                                                     data-toggle="tab">Question</a>
          </li>
          <li role="presentation" id="solution-li"><a href="#solution" aria-controls="solution" role="tab"
                                                      data-toggle="tab"><i class="fas fa-unlock-alt"></i> Solution</a>
          </li>
        </ul>

        <!-- Tab panes -->
        <div class="tab-content">

          <div role="tabpanel" class="tab-pane active" id="question">
            <br/>
            <p>
Given a table <code>tree</code>, <b>id</b> is identifier of the tree node and <b>p_id</b> is its parent node's <b>id</b>.
</p>
 
<pre>
+----+------+
| id | p_id |
+----+------+
| 1  | null |
| 2  | 1    |
| 3  | 1    |
| 4  | 2    |
| 5  | 2    |
+----+------+
</pre>
 
Each node in the tree can be one of three types:</br>
<li>Leaf: if the node is a leaf node.</li>
<li>Root: if the node is the root of the tree.</li>
<li>Inner: If the node is neither a leaf node nor a root node.</li></p>
 
Write a query to print the node id and the type of the node. Sort your output by the node id. The result for the above sample is:</p>
 
<pre>
+----+------+
| id | Type |
+----+------+
| 1  | Root |
| 2  | Inner|
| 3  | Leaf |
| 4  | Leaf |
| 5  | Leaf |
+----+------+
</pre>
</p>
 
<p>
<b>Explanation</b>
</p>
<p>
<li>Node '1' is root node, because its parent node is NULL and it has child node '2' and '3'.</li>
<li>Node '2' is inner node, because it has parent node '1' and child node '4' and '5'.</li>
<li>Node '3', '4' and '5' is Leaf node, because they have parent node and they don't have child node.</li>
</br>
And here is the image of the sample tree as below:
</p>
<pre>
			  1
			/   \
                      2       3
                    /   \
                  4       5
</pre>

<p>
<b>Note</b>
</p>
<p>
If there is only one node on the tree, you only need to output its root attributes.
</p>

          </div>
          <div role="tabpanel" class="tab-pane" id="solution">
            <br/>
            <div class="block-markdown">
<div class="toc">
<ul>
<li><a href="#solution">Solution</a><ul>
<li><a href="#approach-i-using-union-accepted">Approach I: Using UNION [Accepted]</a></li>
<li><a href="#approach-ii-using-flow-control-statement-case-accepted">Approach II: Using flow control statement CASE [Accepted]</a></li>
<li><a href="#approach-iii-using-if-function-accepted">Approach III: Using IF function [Accepted]</a></li>
</ul>
</li>
</ul>
</div>
<h2 id="solution">Solution</h2>
<hr/>
<h4 id="approach-i-using-union-accepted">Approach I: Using <code>UNION</code> [Accepted]</h4>
<p><strong>Intuition</strong></p>
<p>We can print the node type by judging every record by its definition in this table.
<em> Root: it does not have a parent node at all
</em> Inner: it is the parent node of some nodes, and it has a not NULL parent itself.
* Leaf: rest of the cases other than above two</p>
<p><strong>Algorithm</strong></p>
<p>By transiting the node type definition, we can have the following code.</p>
<p>For the root node, it does not have a parent.</p>
<div class="codehilite"><pre><span></span><span class="k">SELECT</span>
    <span class="n">id</span><span class="p">,</span> <span class="s1">'Root'</span> <span class="k">AS</span> <span class="k">Type</span>
<span class="k">FROM</span>
    <span class="n">tree</span>
<span class="k">WHERE</span>
    <span class="n">p_id</span> <span class="k">IS</span> <span class="k">NULL</span>
</pre></div>
<p>For the leaf nodes, they do not have any children, and it has a parent.</p>
<div class="codehilite"><pre><span></span><span class="k">SELECT</span>
    <span class="n">id</span><span class="p">,</span> <span class="s1">'Leaf'</span> <span class="k">AS</span> <span class="k">Type</span>
<span class="k">FROM</span>
    <span class="n">tree</span>
<span class="k">WHERE</span>
    <span class="n">id</span> <span class="k">NOT</span> <span class="k">IN</span> <span class="p">(</span><span class="k">SELECT</span> <span class="k">DISTINCT</span>
            <span class="n">p_id</span>
        <span class="k">FROM</span>
            <span class="n">tree</span>
        <span class="k">WHERE</span>
            <span class="n">p_id</span> <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">)</span>
        <span class="k">AND</span> <span class="n">p_id</span> <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span>
</pre></div>
<p>For the inner nodes, they have have some children and a parent.</p>
<div class="codehilite"><pre><span></span><span class="k">SELECT</span>
    <span class="n">id</span><span class="p">,</span> <span class="s1">'Inner'</span> <span class="k">AS</span> <span class="k">Type</span>
<span class="k">FROM</span>
    <span class="n">tree</span>
<span class="k">WHERE</span>
    <span class="n">id</span> <span class="k">IN</span> <span class="p">(</span><span class="k">SELECT</span> <span class="k">DISTINCT</span>
            <span class="n">p_id</span>
        <span class="k">FROM</span>
            <span class="n">tree</span>
        <span class="k">WHERE</span>
            <span class="n">p_id</span> <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">)</span>
        <span class="k">AND</span> <span class="n">p_id</span> <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span>
</pre></div>
<p>So, one solution to the problem is to combine these cases together using <code>UNION</code>.</p>
<p><strong>MySQL</strong></p>
<div class="codehilite"><pre><span></span><span class="k">SELECT</span>
    <span class="n">id</span><span class="p">,</span> <span class="s1">'Root'</span> <span class="k">AS</span> <span class="k">Type</span>
<span class="k">FROM</span>
    <span class="n">tree</span>
<span class="k">WHERE</span>
    <span class="n">p_id</span> <span class="k">IS</span> <span class="k">NULL</span>

<span class="k">UNION</span>

<span class="k">SELECT</span>
    <span class="n">id</span><span class="p">,</span> <span class="s1">'Leaf'</span> <span class="k">AS</span> <span class="k">Type</span>
<span class="k">FROM</span>
    <span class="n">tree</span>
<span class="k">WHERE</span>
    <span class="n">id</span> <span class="k">NOT</span> <span class="k">IN</span> <span class="p">(</span><span class="k">SELECT</span> <span class="k">DISTINCT</span>
            <span class="n">p_id</span>
        <span class="k">FROM</span>
            <span class="n">tree</span>
        <span class="k">WHERE</span>
            <span class="n">p_id</span> <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">)</span>
        <span class="k">AND</span> <span class="n">p_id</span> <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span>

<span class="k">UNION</span>

<span class="k">SELECT</span>
    <span class="n">id</span><span class="p">,</span> <span class="s1">'Inner'</span> <span class="k">AS</span> <span class="k">Type</span>
<span class="k">FROM</span>
    <span class="n">tree</span>
<span class="k">WHERE</span>
    <span class="n">id</span> <span class="k">IN</span> <span class="p">(</span><span class="k">SELECT</span> <span class="k">DISTINCT</span>
            <span class="n">p_id</span>
        <span class="k">FROM</span>
            <span class="n">tree</span>
        <span class="k">WHERE</span>
            <span class="n">p_id</span> <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">)</span>
        <span class="k">AND</span> <span class="n">p_id</span> <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="n">id</span><span class="p">;</span>
</pre></div>
<h4 id="approach-ii-using-flow-control-statement-case-accepted">Approach II: Using flow control statement <code>CASE</code> [Accepted]</h4>
<p><strong>Algorithm</strong></p>
<p>The idea is similar with the above solution but the code is simpler by utilizing the flow control statements, which is effective to output differently based on different input values. In this case, we can use <a href="https://dev.mysql.com/doc/refman/5.7/en/case.html"><code>CASE</code></a> statement.</p>
<p><strong>MySQL</strong></p>
<div class="codehilite"><pre><span></span><span class="k">SELECT</span>
    <span class="n">id</span> <span class="k">AS</span> <span class="o">`</span><span class="n">Id</span><span class="o">`</span><span class="p">,</span>
    <span class="k">CASE</span>
        <span class="k">WHEN</span> <span class="n">tree</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">atree</span><span class="p">.</span><span class="n">id</span> <span class="k">FROM</span> <span class="n">tree</span> <span class="n">atree</span> <span class="k">WHERE</span> <span class="n">atree</span><span class="p">.</span><span class="n">p_id</span> <span class="k">IS</span> <span class="k">NULL</span><span class="p">)</span>
          <span class="k">THEN</span> <span class="s1">'Root'</span>
        <span class="k">WHEN</span> <span class="n">tree</span><span class="p">.</span><span class="n">id</span> <span class="k">IN</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">atree</span><span class="p">.</span><span class="n">p_id</span> <span class="k">FROM</span> <span class="n">tree</span> <span class="n">atree</span><span class="p">)</span>
          <span class="k">THEN</span> <span class="s1">'Inner'</span>
        <span class="k">ELSE</span> <span class="s1">'Leaf'</span>
    <span class="k">END</span> <span class="k">AS</span> <span class="k">Type</span>
<span class="k">FROM</span>
    <span class="n">tree</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="o">`</span><span class="n">Id</span><span class="o">`</span>
<span class="p">;</span>
</pre></div>
<blockquote>
<p>MySQL provides different flow control statements besides <code>CASE</code>. You can try to rewrite the slution above using <a href="https://dev.mysql.com/doc/refman/5.7/en/control-flow-functions.html#function_if"><code>IF</code></a> flow control statement.</p>
</blockquote>
<h4 id="approach-iii-using-if-function-accepted">Approach III: Using <code>IF</code> function [Accepted]</h4>
<p><strong>Algorithm</strong></p>
<p>Also, we can use a single <a href="https://dev.mysql.com/doc/refman/5.7/en/control-flow-functions.html#function_if"><code>IF</code></a> function instead of the complex flow control statements.</p>
<p><strong>MySQL</strong></p>
<div class="codehilite"><pre><span></span><span class="k">SELECT</span>
    <span class="n">atree</span><span class="p">.</span><span class="n">id</span><span class="p">,</span>
    <span class="k">IF</span><span class="p">(</span><span class="k">ISNULL</span><span class="p">(</span><span class="n">atree</span><span class="p">.</span><span class="n">p_id</span><span class="p">),</span>
        <span class="s1">'Root'</span><span class="p">,</span>
        <span class="k">IF</span><span class="p">(</span><span class="n">atree</span><span class="p">.</span><span class="n">id</span> <span class="k">IN</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">p_id</span> <span class="k">FROM</span> <span class="n">tree</span><span class="p">),</span> <span class="s1">'Inner'</span><span class="p">,</span><span class="s1">'Leaf'</span><span class="p">))</span> <span class="k">Type</span>
<span class="k">FROM</span>
 <span class="err"> </span> <span class="err"> </span><span class="n">tree</span> <span class="n">atree</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="n">atree</span><span class="p">.</span><span class="n">id</span>
</pre></div>
<blockquote>
<p>Note: This solution was inspired by <a href="https://discuss.leetcode.com/user/richarddia">@richarddia</a></p>
</blockquote>
</div>
          </div>
        </div>
      </div>

    </div>

    <aside class="col-md-3  blog-sidebar">
      <div class="row sidebar-module">
        <ul class="list-group">
          <li class="list-group-item"><span>Difficulty:</span><span class="pull-right">
                              
                                <button class="btn btn-xs btn-warning disabled">Medium</button>
                              
          </span></li>
          <li class="list-group-item"><span>Total Accepted:</span><span class="pull-right">2105</span>
          </li>
          <li class="list-group-item"><span>Total Submissions:</span><span
                  class="pull-right">3880</span></li>

          <li class="list-group-item" style="background: #eee;"><span><i
                  class="fas fa-unlock-alt"></i> Frequency:</span>
            <span class="pull-right">
              11%
            </span>
          </li>
        </ul>
        <ul class="list-group">

          <li class="list-group-item">
            <h4><i class="fas fa-unlock-alt"></i> Companies (leaked): </h4>
            
              <a style="margin:2px" class="btn btn-sm btn-success" href="../company/twitter.html">Twitter</a>
            
          </li>

        </ul>
      </div>
    </aside>

  </div>

  <div class="row" >
    <div class="col-md-2">
      <select class="js-example-basic-single" name="state" style="width: 100%;" id="language">
        <option value="cpp">C++</option>
        <option value="py2">Python 2</option>
        <option value="py3">Python 3</option>
      </select>
    </div>
    <div class="col-md-2">

    </div>
  </div>

  <div class="row" >
    <div class="col-md-12 blog-main">
      <div>
        
        <textarea id="code_cpp" name="code_cpp">
          
            
        </textarea>
        
        <textarea id="code_py2" name="code_py2">
          
            
        </textarea>
        
        <textarea id="code_py3" name="code_py3">
          
            
        </textarea>
        
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-md-12 blog-main">
      <a href="#" class="btn btn-primary" id="submit">Submit Solution</a>
    </div>
  </div>



</div>
<!-- /.container -->

<footer class="blog-footer">
  <a href="mailto:leetfree@gmail.com">Email: leetfree@gmail.com</a>
  <p class="pull-right"><a href="#">Back to top</a></p>
</footer>

<!-- Bootstrap core JavaScript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script>
    window.jQuery || document.write('<script src="/assets/js/vendor/jquery.min.js"><\/script>')
</script>
<script src="../js/bootstrap.min.js"></script>
<!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
<script src="../assets/js/ie10-viewport-bug-workaround.js"></script>


<!-- DataTable -->
<!-- <script src="https://cdn.datatables.net/1.10.16/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.10.16/js/dataTables.bootstrap4.min.js"></script> -->

<script src="../main.js"></script>





</body>

</html>